# --------------------------
# 密钥服务器配置（优先使用现代服务器）
# --------------------------
keyserver hkps://keys.openpgp.org  # 最可靠的隐私友好型服务器
keyserver hkps://keyserver.ubuntu.com
# 备用服务器（注释掉以减少网络请求）
# keyserver hkps://pgp.mit.edu

# 禁用不安全的服务器选项
no-honor-keyserver-url  # 忽略密钥中的自定义服务器URL
no-keyserver-options no-import-options  # 安全同步设置

# --------------------------
# 密钥显示和验证设置
# --------------------------
keyid-format 0xlong
with-fingerprint
with-subkey-fingerprint
with-keygrip  # 显示密钥指纹的完整信息

# --------------------------
# 密钥获取策略
# --------------------------
auto-key-locate local,keyserver,wkd  # 增加Web Key Directory支持
auto-key-retrieve  # 谨慎启用（注释掉可提高隐私性）

# --------------------------
# 算法优先级（现代加密标准）
# --------------------------
personal-digest-preferences SHA512 SHA384 SHA256
cert-digest-algo SHA512
default-preference-list SHA512 SHA384 SHA256 AES256 AES192 TWOFISH CAMELLIA256 Uncompressed
personal-cipher-preferences AES256 TWOFISH CAMELLIA256
personal-compress-preferences Uncompressed

# 明确禁用弱算法
disable-cipher-algo 3DES IDEA  # 过时算法
disable-pubkey-algo RSA RSA-S RSA-E  # 弱RSA实现
allow-freeform-uid  # 允许非标准UID格式

# --------------------------
# 密钥生成设置
# --------------------------
default-new-key-algo ed25519/cv25519 SHA512 0
key-display "uid: <%a> %u <%e>"  # 清晰的密钥显示格式

# --------------------------
# Windows 特定配置
# --------------------------
# 使用Git for Windows自带的pinentry
pinentry-program "C:/Program Files/Git/usr/bin/pinentry.exe"

# 智能卡支持（如果有YubiKey等设备）
# scdaemon-program "C:/Program Files/Git/usr/libexec/scdaemon.exe"

# --------------------------
# 安全增强选项
# --------------------------
require-cross-certification  # 强制交叉认证
no-emit-version  # 隐藏GnuPG版本信息
no-comments  # 移除注释减少信息泄露
with-secret-key-encryption  # 加密密钥存储

# 网络请求限制
disable-dirmngr  # 禁用目录管理器（如需启用LDAP）
keyserver-options timeout=10  # 服务器超时设置